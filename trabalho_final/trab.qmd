---
title: "Classificação de Sítio e Análise Econômica das Fazendas"
author: Gabriel de Freitas Pereira
lang: pt
execute:
  echo: false
format:
  pdf:
    toc: true
    number-sections: true
bibliography: references.bib
header-includes: 
   \usepackage{graphicx}
   \usepackage{fancyhdr}
   \pagestyle{fancy}
   \setlength\headheight{28pt}
   \fancyhead[L]{\includegraphics[width=5cm]{chestreelogo.png}}
   \fancyfoot[LE,RO]{chesTree}
editor_options: 
  markdown: 
    wrap: 72
---

![](chestreelogo.png)

*Be the change you want to see in the world*

\newpage

## Apresentação

\  A chesTree é uma empresa de consultoria e serviços florestais,
especializada nos processos que envolvem medições e realizações de
inventários. A chesTree conta com profissionais qualificados e renomados
do mercado, atuando na área florestal desde 1990. A sede da empresa está
localizada em São Paulo, mas conta com filiais espalhadas por todo país.

## Introdução

\  Um inventário florestal é uma prática que busca a quantificação, e por
conseguinte, a qualificação das florestas em diferentes aspectos, como a
produção de madeira e outros possíveis produtos, através do uso de
técnicas estatísticas de amostragem. Considerando que, o inventário visa
obter o máximo de informações de uma floresta com a máxima precisão e o
mínimo custo. Esses três fatores desempenham papel importante no
planejamento de um inventário florestal [@junior2020measure].

\  Sendo assim, o conhecimento dos processos de crescimento e produção de
um povoamento florestal são indubitavelmente necessários ao
gerenciamento racional das florestas plantadas
[@cosenza2015classificaccao]. Logo, as técnicas estatísticas que
envolvem modelagens tornam-se ferramentas importantes para se obter
informações relevantes que auxiliem na tomada de decisões durante o
planejamento florestal, a partir de características encontradas na área
e sua conseguinte prognose de produção gerada. Afinal, o crescimento e a
produção de um povoamento florestal dependem de diversos fatores que
podem ser quantificados e planejados, como a idade, o sítio (potencial
produtivo), os tratos silviculturais, entre outros.

\  Dessa forma, com a intenção de prever o crescimento, são estimadas
variáveis dendrométricas e classes de produtividade ou sítio. Portanto,
a determinação de sítio é de suma importância durante todo o sistema de
prognose e definição das classes de produtividade [@demetodos]. Isso se
deve ao fato de que há uma amplitude de variação dos fatores biológicos,
os quais refletem no crescimento das florestas.

\  Desse modo, é possível concluir que através das estimativas citadas
anteriormente se pode alcançar a máxima eficiência volumétrica, ou seja,
a idade em que o povoamento atinge ao maximizar o incremento médio anual
(IMA), pois o mesmo apresenta um único ponto de máximo quando associado
a curvas de crescimento que apresentam uma fase inicial com ganhos mais
do que proporcionais, seguida de uma fase com ganhos decrescentes
[@rodriguez2010tecnicas]. Logo, saber quando ocorrerá o máximo lucro por
unidade de área é um fator imprescindível para uma empresa florestal, o
qual é perceptível através desse parâmetro.

## Objetivo

\  O presente relatório tem como objetivo utilizar dados de um inventario
florestal contínuo de plantios clonais de *Eucalyptus* sp. no estado de
São Paulo para:

-   classificar os sítios das três fazendas;

-   recomendar a idade ótima de corte;

-   definir qual a fazenda mais lucrativa dentro das condições
    existentes para possível implantação da floresta.

## Metodologia

### Coleta de dados e classificação de sítios

\  Inicialmente, os primeiros aspectos da área foram fornecidos pelo
proprietário da área e foram analisadas presencialmente na fazenda, e
essas informações eram sobre o espaçamento, tipo de solo, relevo,
presença de patógenos, umidade do solo, entre outras informações gerais.
Depois desse processo, os dados de diâmetro à altura do peito (DAP)
foram coletados a 1,3 m do solo, através do uso de uma fita métrica no
sentido horizontal em relação ao solo. Quando as árvores estavam em
terreno inclinado, a medição foi realizada no ponto mais elevado e no
caso das árvores inclinadas a fita métrica foi colocada no sentido
perpendicular ao eixo do tronco da árvore. A altura total foi medida
através de um hipsômetro Suunto. As informações adquiridas foram
armazenadas em tablets, assim como o registro de informações como a
localização e identificação da área e locais de acesso.

\  Com isso, o procedimento de amostragem que foi adotado na realização
do inventário após a análise dos dados foi a amostragem casual simples
com parcelas circulares. Esse tipo de amostragem é um método utilizado
em populações homogêneas e foi escolhido, justamente, por conta dessa
característica do povoamento. Além disso, o procedimento de inventário
florestal citado anteriormente foi repetido ao longo dos anos, de forma
contínua, com o objetivo de processar os dados nos softwares R 4.2.1 e
Microsoft Excel.

\  Sendo assim, para a classificação de sítios, foram avaliados os modelos
hipsométricos apresentados a seguir, tanto na forma anamórfica quanto
polimórfica.

\

Chapman-Richards

-   anamórfico:
    $Hd_2 = H d_1 * \left[\frac{ ( 1 - e ^ {\beta_1Id_1} ) ^ { \beta_2} } { ( 1 - e ^ {\beta_2Id_2} ) } \right]$

-   polimórfico:
    $Hd2 = \beta_0 * \left( \frac{ Hd_1 } {\beta_0} \right) ^{\frac{ log( 1 - e ^ {\beta*1Id_2 } ) } {log( 1 - e ^ {*\beta 1Id_1} ) } }$

Schumacher

-   anamórfico:
    $Hd_2 = Hd_1 * e^{\beta_1 \left( \frac{ 1 } { Id_2} - \frac{ 1 } { Id_1 } \right)}$

-   polimórfico:
    $Hd_2 = \beta_0 \left( \frac{ Hd_1 } { \beta_0 }\right)^{ \frac{ Id_1 } { Id_2 } }$

Bailey-Clutter

-   anamórfico:
    $Hd_ 2 = \frac{ Hd_1 } { e^{ \beta_1^{ ( Id_ 2 ^{\beta_2} - Id_1 ^{ \beta_2}) } } }$

-   polimórfico:
    $Hd_2 = \beta_0 \left( \frac{ Hd_1 } { \beta_0 } \right )^{ \left( \frac{ Id_1 } { Id_2 } \right ) ^{ \beta_2 } }$

\  A partir da avaliação feita com base na análise gráfica e atributos
estatísticos gerados, foi escolhido o melhor modelo para prosseguir com
a classificação de sítio. Dessa forma, a idade referência utilizada para
classificar as parcelas medidas foi a de 72 meses, com sítios divididos
em quatro classes.

\  Além disso, visando garantir a melhor escolha possível do modelo foram
comparadas as estabilidades entre parcelas dos dois melhores modelos,
escolhendo o modelo mais estável. E com isso, finalmente foi realizada a
reclassificação analisando como a altura varia de acordo com a idade da
floresta.

### Prognose e rotação técnica de corte

\  Para estimar a produção do volume, foi realizada a prognose e rotação
nas diferentes idades (24, 36, 48, 60, 72, 84, 96, 108, 120 meses) dos
talhões analisados. Sendo que, foi utilizado o modelo volumétrico de
Clutter (representado a seguir), do qual foram analisados seus
respectivos atributos estatísticos e gráficos.

$lnV = \beta_0 + \beta_1 * \frac{1} {S} + \beta_2 * \frac{1} {Id2} + \beta_3 * \left(\frac{Id_1}{Id_2}\right) * ln(ab_1) + \beta_4 * \left( 1 - \frac{Id_1}{Id_2}\right) + \beta_5 * \left( 1 - \frac{Id_1}{Id_2}\right) * S$

A equação acima considera que:

-   $V$ = volume de madeira (m³) na idade 2;

-   $S$ = valor central da classe de sítio da parcela (m);

-   $Id$ = idade (meses);

-   $ab$ = área basal (m³/ha).

\  Então, a partir das estimativas de área basal foram calculados o
Incremento Corrente Anual (ICA) e o Incremento Médio Anual (IMA) para os
talhões analisados, de acordo com as fórmulas apresentadas abaixo.

$IMA = \frac{V_{Id}} {Id}$

$ICA = V_{Id_2} - V_{Id_1}$

onde:

$V_{Id}$ = volume na idade n;

$Id$ = idade n.

### Análise econômica

\  Com o intuito de determinar a idade ótima de corte foi realizada uma
análise econômica, considerando que os anos e custos das operações foram
anexados neste documento, para facilitar a visualização das premissas
usadas. Logo, a partir desses dados, foi gerada uma planilha de fluxo de
caixa de cada talhão analisado, com valores de Receitas e Custos para
cada ano de plantio. Desse modo, os seguintes valores foram calculados:
Valor Presente das Receitas (VPR), Valor Presente dos Custos (VPC),
Valor Presente Líquido (VPL), Valor Presente Líquido Infinito (VPL inf),
Custo Médio da Produção (CMPr), Relação Benefício Custo (B/C), Valor
Esperado da Terra (VET) e a Taxa Interna de Retorno (TIR).

\  A análise econômica foi realizada de forma principal através do VPL,
considerando um horizonte infinito (VPL infinito), pois dessa maneira é
possível comparar projetos com durações diferentes. Dessa forma os
projetos foram avaliados. Algumas das fórmulas estão apresentadas
abaixo:

$$VPL = VP - VPC$$

Sendo:

$VPC$ = valor presente do custo

$VP$ = valor presente

$$
VPLinf = \frac{VP(1+i)^t} {(1+i)^t-1}  = \frac{VP} {(1-(1+i)^t)}
$$

Sendo:

$t$ em anos e taxa $i$ anual

ou

$t$ em meses e taxa $i$ mensal

$$BC = \frac{VP}{VPC}$$ Em que:

$VPC$ = valor presente do custo

$$\sum_{j=0}^{n} C_j(1 + TIR)^{−j}$$

Em que:

$C_j$ = valor atual dos custos;

$j$ = período em que os custos ou receitas ocorrem;

$n$ = duração do projeto.

\ 

\  Esses valores gerados serão devidamente comentados posteriormente
neste relatório, de acordo com as interpretações geradas e suas
motivações.

### Análise de sensibilidade

\  Portanto, com a análise econômica florestal realizada, foram
especulados cenários existentes e suas respectivas alterações em valores
como o custo da terra, custos de venda da madeira e custos atrelados ao
transporte da madeira.

## Resultados e discussão

```{r setup, include=FALSE, echo = FALSE}
library( cmrinvflor )
library( ggplot2 )
library( magick )
library( cowplot )
library( gridExtra )
library( qqplotr )

dados_npar <- read.csv2( "ifc.csv" )
names( dados_npar )
dados_npar <- dados_npar[ c( "parcela", "idade", "hdom", "ab", "vtsc", "vtcc" ) ]

dados <- cmrinvflor::parear_seqmed( dados_npar )
```

### Estatísticas dos modelos e classes de sítio


```{r}
### Ajustes dos modelos de classificação de sítios 

# Ajustes Bailey Clutter --------------------------------------------------

# Ajuste Bailey Clutter polimórfico

bc_poli <- "hdom2~b0*((hdom1/b0)^((idade1/idade2)^b2))"

ajbcpoli <- nls(
  formula = bc_poli,
  data = dados,
  start = list(
    b0 = 50, 
    b2 = 0.5
  )
)

#Erro padrão residual
syxbcpoli <- summary( ajbcpoli )$sigma
syxperbcpoli <- syxbcpoli / mean( dados$hdom2 ) * 100

#coeficientes bc poli
cfbcpoli <- as.vector( coef( ajbcpoli ) )

#Ajuste Bailey Clutter anamórfico

bc_ana <- "hdom2~hdom1/(exp(b1*((idade2^b2)-(idade1^b2))))"

ajbcana <- nls(
  formula = bc_ana,
  data = dados,
  start = list(
    b1 = 7.9378414, 
    b2 = -0.4497666
  )
)

#Erro padrão residual
syxbcana <- summary( ajbcana )$sigma
syxperbcana <- syxbcana / mean( dados$hdom2 ) * 100

#coeficientes bc poli
cfbcana <- as.vector( coef( ajbcana ) )

# Ajustes Chapman e Richards --------------------------------------------------

# Ajuste Chapman e Richards polimórfico

cr_poli <- "hdom2~b0*((hdom1/b0)^((log(1-exp(b1*idade2)))/(log(1-exp(b1*idade1)))))"

ajcrpoli <- nls(
  formula = cr_poli,
  data = dados,
  start = list(
    b0 = 35.2288428, 
    b1 = -0.0221952
  )
)

#Erro padrão residual
syxcrpoli <- summary( ajcrpoli )$sigma
syxpercrpoli <- syxcrpoli / mean( dados$hdom2 ) * 100

#coeficientes cr poli
cfcrpoli <- as.vector( coef( ajcrpoli ) )

#Ajuste Chapman e Richards anamórfico

cr_ana <- "hdom2~((hdom1*(1-exp(b1*(idade2))))/(1-exp(b1*(idade1))))^b2"

ajcrana <- nls(
  formula = cr_ana,
  data = dados,
  start = list(
    b1 = -0.01949213, 
    b2 = 1.05428713
  )
)

#Erro padrão residual
syxcrana <- summary( ajcrana )$sigma
syxpercrana <- syxcrana / mean( dados$hdom2 ) * 100

#coeficientes cr poli
cfcrana <- as.vector( coef( ajcrana ) )

# Ajustes Schumacher --------------------------------------------------

# Ajuste Schumacher polimórfico

sch_poli <- "hdom2~b0*((hdom1/b0)^((idade1)/(idade2)))"

ajschpoli <- nls(
  formula = sch_poli,
  data = dados,
  start = list(
    b0 = 39.1903
  )
)

#Erro padrão residual
syxschpoli <- summary( ajschpoli )$sigma
syxperschpoli <- syxschpoli / mean( dados$hdom2 ) * 100

#coeficientes sch poli
cfschpoli <- as.vector( coef( ajschpoli ) )

#Ajuste Schumacher anamórfico

sch_ana <- "hdom2~hdom1*(exp(b1*((1/idade2)-(1/idade1))))"

ajschana <- nls(
  formula = sch_ana,
  data = dados,
  start = list(
    b1 = 25.59895
  )
)

#Erro padrão residual
syxschana <- summary( ajschana )$sigma
syxperschana <- syxschana / mean( dados$hdom2 ) * 100

#coeficientes sch ana
cfschana <- as.vector( coef( ajschana ) )

```

\  A Tabela 1 apresenta todos os coeficientes obtidos de cada modelo testado e seus respectivos valores de erro padrão residual. Antes de analisar os resultados, é importante salientar que quanto maior o erro padrão residual mais distante do ideal o modelo se encontra, ou seja, os resíduos estão mais distantes do valor real. Desse
modo, comparando os modelos de forma **isolada a partir dessa métrica
estatística** os modelos de Bailey-Clutter polimórfico e Chapman-Richards polimórfico, obtiveram os melhores resultados para as estimativas realizadas. Sendo possível destacar o polimorfismo como a forma que mais se aproxima do ideal em cada modelo testado, o que é esperado teoricamente, considerando os fatores biológicos que afetam as florestas. 


| Modelos                        | $\beta_0$               |$\beta_1$                  |$\beta_2$                 | Erro padrão residual (%) |  
|--------------------------------|-------------------------|---------------------------|--------------------------|--------------------------|
| Bailey-Clutter (polimórfico)   |`r round(cfbcpoli,6)[1]` |                           |`r round(cfbcpoli,6)[2]`  |`r round(syxperbcpoli, 2)`|
| Bailey-Clutter (anamórfico)    |                         |`r round(cfbcana, 6)[1]`   |`r round(cfbcana,6)[2]`   |`r round(syxperbcana, 2)` |
| Chapman-Richards (polimórfico) |`r round(cfcrpoli,6)[1]` |`r round(cfcrpoli, 6)[2]`  |                          |`r round(syxpercrpoli, 2)`|
| Chapman-Richards (anamórfico)  |                         |`r round(cfcrana, 6)[1]`   |`r round(cfcrana,6)[2]`   |`r round(syxpercrana, 2)` |
| Schumacher (polimórfico)       |`r round(cfschpoli,6)[1]`|                           |                          |`r round(syxperschpoli,2)`|
| Schumacher (anamórfico)        |                         |`r round(cfschana, 6)[1]`  |                          |`r round(syxperschana, 2)`|
: Coeficientes e erro padrão residual obtidos com o ajuste dos modelos.


\  Dessa forma, o modelo de Chapman-Richards foi o modelo escolhido, pois além do seu desempenho através da métrica citada anteriormente ter sido o superior, esse foi o modelo que apresentou a melhor distribuição de resíduos devido os resultados estarem mais agrupados em torno do zero (Figura 1), quando comparado com as distribuições dos demais modelos testados a um nível de significância de 5%, os quais estão anexados neste documento.


```{r, echo=FALSE, include = FALSE}
# gráfico de sítios
# Avaliação de estabilidade dos modelos Bailey & Clutter Polimórfico e Chapman & Richards Polimórfico.

### Análise gráfica dos #ajustes

img <- image_read( "chestreelogo.PNG" )

theme_chesTree <- theme_bw( ) +
  theme( panel.grid.major = element_line( color = "gray70", linetype = "dashed" ),
         panel.grid.minor = element_blank( ),
         axis.title = element_text( size = rel( 0.7 ) ),
         axis.text = element_text( size = rel( 1.0 ) ),
         legend.position = c( 0, 1 ),
         legend.justification = c( -0.05, 1.02 ),
         legend.title = element_blank( ),
         legend.text = element_text( size = rel( 0.8 ) ) )

p <- ggplot( dados, aes( x = idade2, y = hdom2, color = "lightgreen" ) ) +
  geom_point( size = 1.5 , alpha = 0.5) +
  #labs( title = "Testando título" ) +
  #geom_hline( yintercept = 0, linetype = "dashed" ) +
  geom_smooth( se = TRUE, method = "loess", formula = "y ~ x" ) +
  scale_y_continuous( name = "Altura Dominante (cm)" ) +
  scale_x_continuous( name = "Idade (meses)" ) +
  scale_color_manual( values = c( "#50B23D","#0072B2" ), guide = "none" ) +
  scale_fill_manual( values = c( "#E69F00","#0072B2" ), guide = "none" ) +
  theme_chesTree

hdom2_idade2_plot_anexos <- ggdraw( ) +
  draw_plot( p, x = 0, y = 0.15, width = 1, height = 0.85 ) +
  draw_image( img, x = 0.65, y = 0.02, width = 0.35, height = 0.2 )  

# A curva no gráfico acima é conhecida como LOESS 
# (suavização de dispersão estimada localmente),
# e ela nos mostra o melhor ajuste sem assumir
# que os dados devem se ajustar a alguma forma de distribuição.
# Além disso, foi apresentado o erro padrão em torno da curva em cinza.

# par( mfrow = c( 1, 1 ) )
# with( dados, plot( hdom1, hdom2, pch = 20 ) )



# Gráficos ----------------------------------------------------------------

#Calculando os resíduos

#Bailey clutter
dados$resbcpoli <- residuals( ajbcpoli ) #polimórfico
dados$resbcana <- residuals( ajbcana ) #anamórfico

#Chapman e Richards
dados$rescrpoli <- residuals( ajcrpoli ) #polimórfico
dados$rescrana <- residuals( ajcrana ) #anamórfico

#Schumacher
dados$resschpoli <- residuals( ajschpoli ) #polimórfico
dados$resschana <- residuals( ajschana ) #anamórfico

#gráficos com casca

theme_chesTree <- theme_bw( ) +
  theme( panel.grid.major = element_line( color = "gray70", linetype = "dashed" ),
         panel.grid.minor = element_blank( ),
         plot.title = element_text( size = 7 ),
         axis.title = element_text( size = rel( 0.9 ) ),
         axis.text = element_text( size = rel( 0.6 ) ),
         legend.position = c( 0, 1 ),
         legend.key = element_rect( fill = "transparent" ),
         legend.key.size = unit( 0.05, "cm" ),
         legend.justification = c( -0.01, 0.9 ),
         legend.title = element_blank( ),
         legend.text = element_text( size = rel( 0.5 ) ) )

bcnorm_poli <- ggplot( data = dados, mapping = aes( sample = resbcpoli ) ) +
  geom_qq_band( bandType = "pointwise", mapping = aes( fill = "Normal" ), alpha = 0.5 ) +
  geom_qq_band( bandType = "boot", mapping = aes( fill = "Bootstrap" ), alpha = 0.5 ) +
  stat_qq_line( ) +
  stat_qq_point( size = 0.4 ) +
  labs( title = "Bailey-Clutter Polimórfico",
        x = "", 
        y = "" ) +
  scale_fill_discrete( "Faixas de Confiança" ) +
  theme_chesTree

bcnorm_ana <- ggplot( data = dados, mapping = aes( sample = resbcana ) ) +
  geom_qq_band( bandType = "boot", mapping = aes( fill = "Bootstrap" ), alpha = 0.5 ) +
  geom_qq_band( bandType = "pointwise", mapping = aes( fill = "Normal" ), alpha = 0.5 ) +
  stat_qq_line( ) +
  stat_qq_point( size = 0.4 ) +
  labs( title = "Bailey-Clutter Anamórfico",
        x = "", 
        y = "Quantil amostral" ) +
  scale_fill_discrete( "Faixas de Confiança" )+
  theme_chesTree

crnorm_poli <- ggplot( data = dados, mapping = aes( sample = rescrpoli ) ) +
  geom_qq_band( bandType = "ks", mapping = aes( fill = "KS" ), alpha = 0.5 ) +
  geom_qq_band( bandType = "ts", mapping = aes( fill = "TS" ), alpha = 0.5 ) +
  geom_qq_band( bandType = "boot", mapping = aes( fill = "Bootstrap" ), alpha = 0.5 ) +
  geom_qq_band( bandType = "pointwise", mapping = aes( fill = "Pointwise" ), alpha = 0.5 ) +
  stat_qq_line( ) +
  stat_qq_point( size = 0.7 ) +
  labs( title = "Chapman-Richards Polimórfico",
        x = "Quantis Normais", 
        y = "Quantil Amostral" ) +
  scale_fill_discrete( "Faixas de Confiança" ) +
  theme_chesTree

crnorm_ana <- ggplot( data = dados, mapping = aes( sample = rescrana ) ) +
  geom_qq_band( bandType = "boot", mapping = aes( fill = "Bootstrap" ), alpha = 0.5 ) +
  geom_qq_band( bandType = "pointwise", mapping = aes( fill = "Normal" ), alpha = 0.5 ) +
  stat_qq_line( ) +
  stat_qq_point( size = 0.4 ) +
  labs( title = "Chapman-Richards Anamórfico",
        x = "Quantis Normais", 
        y = "" ) +
  scale_fill_discrete( "Faixas de Confiança" )+
  theme_chesTree

scnorm_poli <- ggplot( data = dados, mapping = aes( sample = resschpoli ) ) +
  geom_qq_band( bandType = "boot", mapping = aes( fill = "Bootstrap" ), alpha = 0.5 ) +
  geom_qq_band( bandType = "pointwise", mapping = aes( fill = "Normal" ), alpha = 0.5 ) +
  stat_qq_line( ) +
  stat_qq_point( size = 0.4 ) +
  labs( title = "Shcumacher Polimórfico",
        x = "Quantis Normais", 
        y = "Quantil amostral" ) +
  scale_fill_discrete( "Faixas de Confiança" )+
  theme_chesTree

scnorm_ana <- ggplot( data = dados, mapping = aes( sample = resschana ) ) +
  geom_qq_band( bandType = "boot", mapping = aes( fill = "Bootstrap" ), alpha = 0.5 ) +
  geom_qq_band( bandType = "pointwise", mapping = aes( fill = "Normal" ), alpha = 0.5 ) +
  stat_qq_line( ) +
  stat_qq_point( size = 0.4 ) +
  labs( title = "Schumacher Anamórfico",
        x = "Quantis Normais", 
        y = "" ) +
  scale_fill_discrete( "Faixas de Confiança" )+
  theme_chesTree

# "pointwise" constrói bandas de confiança simultâneas com base na distribuição normal;
# "boot" cria bandas de confiança pontuais com base em um boostrap paramétrico;
# "ks" constrói bandas de confiança simultâneas com base em uma inversão do teste de Kolmogorov-Smirnov;
# "ts" constrói bandas de confiança sensíveis à cauda, como proposto por Aldor-Noiman et al. (2013).

margin <- theme( plot.margin = unit( c( 0, 0, 0, 0 ), "cm" ) )

arranged_norm <- grid.arrange(
                               grobs = lapply( list( bcnorm_ana, bcnorm_poli, crnorm_ana,
                               scnorm_poli, scnorm_ana ), "+", margin ), 
                               heights = c( 4,4 ) )
# anexos
norm_plot_anexos <- ggdraw( ) +
  draw_plot( arranged_norm, x = 0, y = 0.15, width = 1, height = 0.85 ) +
  draw_image( img, x = 0.66, y = 0.02, width = 0.35, height = 0.65 )  


### Resíduos

res_plot_bcpoli <- ggplot( dados, aes( x = idade1, y = resbcpoli, color = "lightgreen" ) ) +
  geom_point( size = 0.9 , alpha = 0.5 ) +
  labs( title = "Bailey-Clutter Polimórfico" ) +
  geom_hline( yintercept = 0, col = "black" ) +
  geom_smooth( se = TRUE, method = "loess", formula = "y ~ x" ) +
  scale_y_continuous( limits = c( -8, 8 ), breaks = c(-8, -4, 0, 4, 8 ), name = "" ) +
  scale_x_continuous( name = "" ) +
  scale_color_manual( values = c( "#50B23D","#0072B2" ), guide = "none" ) +
  scale_fill_manual( values = c( "#E69F00","#0072B2" ), guide = "none" ) +
  theme_chesTree

# anexos
res_plot_bcana <- ggplot( dados, aes( x = idade1, y = resbcana, color = "lightgreen" ) ) +
  geom_point( size = 0.9 , alpha = 0.5 ) +
  labs( title = "Bailey-Clutter Anamórfico" ) +
  geom_hline( yintercept = 0, col = "black" ) +
  geom_smooth( se = TRUE, method = "loess", formula = "y ~ x" ) +
  scale_y_continuous( name = "" ,
                      limits = c( -8, 8 ), breaks = c( -8, -4, 0, 4, 8  ) ) +
  scale_x_continuous( name = "" ) +
  scale_color_manual( values = c( "#50B23D","#0072B2" ), guide = "none" ) +
  scale_fill_manual( values = c( "#E69F00","#0072B2" ), guide = "none" ) +
  theme_chesTree

res_plot_crpoli <- ggplot( dados, aes( x = idade1, y = rescrpoli, color = "lightgreen" ) ) +
  geom_point( size = 1.5 , alpha = 0.5 ) +
  labs( title = "" ) +
  geom_hline( yintercept = 0, col = "black" ) +
  geom_smooth( se = TRUE, method = "loess", formula = "y ~ x" ) +
  scale_y_continuous( limits = c( -8, 8 ), breaks = c( -8, -4, 0, 4, 8  ), name = "Resíduos (m)" ) +
  scale_x_continuous( name = "Idade (meses)" ) +
  scale_color_manual( values = c( "#50B23D","#0072B2" ), guide = "none" ) +
  scale_fill_manual( values = c( "#E69F00","#0072B2" ), guide = "none" ) +
  theme_chesTree

arranged_res_norm <- grid.arrange( crnorm_poli, res_plot_crpoli, ncol = 2 )

res_norm_plot <- ggdraw( ) +
  draw_plot( arranged_res_norm, x = 0, y = 0.15, width = 1, height = 0.85 ) +
  draw_image( img, x = 0.35, y = 0.02, width = 0.35, height = 0.2 )  

res_plot_crana <- ggplot( dados, aes( x = idade1, y = rescrana, color = "lightgreen" ) ) +
  geom_point( size = 0.9 , alpha = 0.5 ) +
  labs( title = "Chapman-Richards Anamórfico" ) +
  geom_hline( yintercept = 0, col = "black" ) +
  geom_smooth( se = TRUE, method = "loess", formula = "y ~ x" ) +
  scale_y_continuous( limits = c( -8, 8 ), breaks = c(-8, -4, 0, 4, 8 ), name = "Resíduos (m)" ) +
  scale_x_continuous( name = "" ) +
  scale_color_manual( values = c( "#50B23D","#0072B2" ), guide = "none" ) +
  scale_fill_manual( values = c( "#E69F00","#0072B2" ), guide = "none" ) +
  theme_chesTree

res_plot_schpoli <- ggplot( dados, aes( x = idade1, y = resschpoli, color = "lightgreen" ) ) +
  geom_point( size = 0.9 , alpha = 0.5 ) +
  labs( title = "Schumacher Polimórfico" ) +
  geom_hline( yintercept = 0, col = "black" ) +
  geom_smooth( se = TRUE, method = "loess", formula = "y ~ x" ) +
  scale_y_continuous( name = "" ,
                      limits = c( -8, 8 ), breaks = c(-8, -4, 0, 4, 8 ), 
                      ) +
  scale_x_continuous( name = "Idade (meses)" ) +
  scale_color_manual( values = c( "#50B23D","#0072B2" ), guide = "none" ) +
  scale_fill_manual( values = c( "#E69F00","#0072B2" ), guide = "none" ) +
  theme_chesTree

res_plot_schana <- ggplot( dados, aes( x = idade1, y = resschana, color = "lightgreen" ) ) +
  geom_point( size = 0.9 , alpha = 0.5 ) +
  labs( title = "Schumacher Anamórfico" ) +
  geom_hline( yintercept = 0, col = "black" ) +
  geom_smooth( se = TRUE, method = "loess", formula = "y ~ x" ) +
  scale_y_continuous( limits = c( -8, 8 ), breaks = c(-8, -4, 0, 4, 8 ), name = "" ) +
  scale_x_continuous( name = "Idade (meses)" ) +
  scale_color_manual( values = c( "#50B23D","#0072B2" ), guide = "none" ) +
  scale_fill_manual( values = c( "#E69F00","#0072B2" ), guide = "none" ) +
  theme_chesTree

margin <- theme( plot.margin = unit( c( 0.01, 0.0001, 0.0001, 0.2 ), "cm" ) )
arranged_res <- grid.arrange( ncol = 2, nrow = 3, 
                              grobs = lapply( list( res_plot_bcpoli, res_plot_bcana, 
                              res_plot_crana,
                              res_plot_schpoli, res_plot_schana ), "+", margin ) )
# anexos
res_plot_anexos <- ggdraw( ) +
  draw_plot( arranged_res, x = 0, y = 0.15, width = 1, height = 0.85 ) +
  draw_image( img, x = 0.58, y = 0.02, width = 0.35, height = 0.5 )  

```


```{r}
#| fig-cap: Gráfico quantil-quantil e gráfico da distribuição de resíduos.

res_norm_plot

```

\  Ademais, também na Figura 1, é foram geradas faixas de confiança simultâneas com base na distribuição normal, técnica conhecida como _Pointwise_; faixas de confiança pontuais com base em um bootstrap paramétrico; bandas de confiança simultâneas com base em uma inversão do teste de Kolmogorov-Smirnov (KS) e faixas de confiança sensíveis à cauda, como proposto por [@aldor2013power]. E a reta estimada estava contida dentro desses intervalos, para todas as técnicas citadas, afirmando normalidade.

\  Outrossim, com o intuito de comparar as estabilidades entre parcelas dos modelos, foram destacadas a quantidade de mudanças de classe observadas. 



### Prognose e idade ótima de corte

### Análise econômica

### Sensibilidade econômica

## Conclusão

## Referências


```{r}
#| fig-cap: Gráficos da distribuição de resíduos dos modelos que não foram selecionados.

res_plot_anexos
```

```{r}
#| fig-cap: Gráficos quantil-quantil dos modelos que não foram selecionados.

norm_plot_anexos
```

